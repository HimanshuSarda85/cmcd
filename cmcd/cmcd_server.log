2025-07-14 18:55:49.913 | INFO     | __main__:main:538 - Starting CMCD MCP Server
2025-07-14 18:56:06.815 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-3h, session_id=None, content_id=None
2025-07-14 18:56:06.894 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response body: b'Client sent an HTTP request to an HTTPS server.\n'

2025-07-14 18:56:06.894 | WARNING  | __main__:get_average_bitrate:240 - No bitrate data found in initial check
2025-07-14 18:56:06.947 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response body: b'Client sent an HTTP request to an HTTPS server.\n'

2025-07-14 18:56:06.947 | WARNING  | __main__:get_average_bitrate:253 - No bitrate data found in second check either
2025-07-14 18:56:06.997 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response body: b'Client sent an HTTP request to an HTTPS server.\n'

2025-07-14 18:56:06.997 | INFO     | __main__:get_average_bitrate:259 - Available buckets: {'status': 'error', 'message': "(400)\nReason: Bad Request\nHTTP response body: b'Client sent an HTTP request to an HTTPS server.\\n'\n"}
2025-07-14 18:58:24.678 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-3h, session_id=None, content_id=None
2025-07-14 18:58:24.727 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response body: b'Client sent an HTTP request to an HTTPS server.\n'

2025-07-14 18:58:24.727 | WARNING  | __main__:get_average_bitrate:240 - No bitrate data found in initial check
2025-07-14 18:58:24.775 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response body: b'Client sent an HTTP request to an HTTPS server.\n'

2025-07-14 18:58:24.776 | WARNING  | __main__:get_average_bitrate:253 - No bitrate data found in second check either
2025-07-14 18:58:24.824 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response body: b'Client sent an HTTP request to an HTTPS server.\n'

2025-07-14 18:58:24.824 | INFO     | __main__:get_average_bitrate:259 - Available buckets: {'status': 'error', 'message': "(400)\nReason: Bad Request\nHTTP response body: b'Client sent an HTTP request to an HTTPS server.\\n'\n"}
2025-07-14 18:59:37.469 | INFO     | __main__:main:538 - Starting CMCD MCP Server
2025-07-14 18:59:44.988 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-14 18:59:45.010 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)
2025-07-14 18:59:45.011 | WARNING  | __main__:get_average_bitrate:240 - No bitrate data found in initial check
2025-07-14 18:59:45.013 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)
2025-07-14 18:59:45.014 | WARNING  | __main__:get_average_bitrate:253 - No bitrate data found in second check either
2025-07-14 18:59:45.017 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)
2025-07-14 18:59:45.017 | INFO     | __main__:get_average_bitrate:259 - Available buckets: {'status': 'error', 'message': "HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)"}
2025-07-14 20:18:28.660 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-14 20:18:28.677 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)
2025-07-14 20:18:28.677 | WARNING  | __main__:get_average_bitrate:240 - No bitrate data found in initial check
2025-07-14 20:18:28.682 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)
2025-07-14 20:18:28.682 | WARNING  | __main__:get_average_bitrate:253 - No bitrate data found in second check either
2025-07-14 20:18:28.687 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)
2025-07-14 20:18:28.688 | INFO     | __main__:get_average_bitrate:259 - Available buckets: {'status': 'error', 'message': "HTTPSConnectionPool(host='localhost', port=8086): Read timed out. (read timeout=0.001)"}
2025-07-14 20:22:19.309 | INFO     | __main__:main:547 - Starting CMCD MCP Server
2025-07-14 20:22:44.084 | INFO     | __main__:get_average_bitrate:234 - Getting average bitrate for time_range=-3h, session_id=None, content_id=None
2025-07-14 20:22:44.274 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:22:44.275 | WARNING  | __main__:get_average_bitrate:249 - No bitrate data found in initial check
2025-07-14 20:22:44.443 | ERROR    | __main__:get_cmcd_data:220 - Error querying InfluxDB: (404)
Reason: Not Found
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'not found', 'Date': 'Tue, 15 Jul 2025 00:22:44 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"not found","message":"failed to initialize execute state: could not find bucket \\"cmcd_metrics\\""}'

2025-07-14 20:22:44.444 | WARNING  | __main__:get_average_bitrate:262 - No bitrate data found in second check either
2025-07-14 20:22:44.614 | INFO     | __main__:get_cmcd_data:216 - Query returned 3 records
2025-07-14 20:22:44.616 | INFO     | __main__:get_average_bitrate:268 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 20:28:35.078 | INFO     | __main__:get_average_bitrate:234 - Getting average bitrate for time_range=-3h, session_id=None, content_id=None
2025-07-14 20:28:35.250 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:28:35.251 | WARNING  | __main__:get_average_bitrate:249 - No bitrate data found in initial check
2025-07-14 20:28:35.417 | ERROR    | __main__:get_cmcd_data:220 - Error querying InfluxDB: (404)
Reason: Not Found
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'not found', 'Date': 'Tue, 15 Jul 2025 00:28:35 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"not found","message":"failed to initialize execute state: could not find bucket \\"cmcd_metrics\\""}'

2025-07-14 20:28:35.418 | WARNING  | __main__:get_average_bitrate:262 - No bitrate data found in second check either
2025-07-14 20:28:35.585 | INFO     | __main__:get_cmcd_data:216 - Query returned 3 records
2025-07-14 20:28:35.585 | INFO     | __main__:get_average_bitrate:268 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 20:29:35.073 | INFO     | __main__:main:754 - Starting CMCD MCP Server
2025-07-14 20:29:39.883 | INFO     | __main__:get_average_bitrate:234 - Getting average bitrate for time_range=-3h, session_id=None, content_id=None
2025-07-14 20:29:40.069 | INFO     | __main__:get_cmcd_data:216 - Query returned 3 records
2025-07-14 20:29:40.071 | INFO     | __main__:get_average_bitrate:241 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 20:29:40.071 | INFO     | __main__:get_average_bitrate:250 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 20:29:40.071 | INFO     | __main__:get_average_bitrate:257 - Selected bucket: cmcd-metrics
2025-07-14 20:29:40.253 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:29:40.254 | WARNING  | __main__:get_average_bitrate:281 - No bitrate data found in bucket cmcd-metrics
2025-07-14 20:29:40.428 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:29:42.617 | INFO     | __main__:get_cmcd_data:216 - Query returned 3 records
2025-07-14 20:29:42.618 | INFO     | __main__:explore_database:693 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 20:29:42.785 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:29:42.954 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:29:43.222 | INFO     | __main__:get_cmcd_data:216 - Query returned 230 records
2025-07-14 20:29:45.650 | INFO     | __main__:get_average_bitrate:234 - Getting average bitrate for time_range=-3h, session_id=None, content_id=None
2025-07-14 20:29:45.817 | INFO     | __main__:get_cmcd_data:216 - Query returned 3 records
2025-07-14 20:29:45.818 | INFO     | __main__:get_average_bitrate:241 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 20:29:45.818 | INFO     | __main__:get_average_bitrate:250 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 20:29:45.818 | INFO     | __main__:get_average_bitrate:257 - Selected bucket: cmcd-metrics
2025-07-14 20:29:45.990 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 20:29:45.992 | WARNING  | __main__:get_average_bitrate:281 - No bitrate data found in bucket cmcd-metrics
2025-07-14 20:29:46.163 | INFO     | __main__:get_cmcd_data:216 - Query returned 0 records
2025-07-14 21:10:27.908 | INFO     | __main__:main:865 - Starting CMCD MCP Server
2025-07-14 21:10:50.285 | ERROR    | __main__:generate_test_data:860 - Error generating test data: <urllib3.connection.HTTPSConnection object at 0x1172eb2f0>: Failed to establish a new connection: [Errno 61] Connection refused
2025-07-14 21:11:47.491 | INFO     | __main__:generate_test_data:844 - Writing 201 points to bucket 'cmcd-metrics'
2025-07-14 21:11:47.683 | ERROR    | __main__:generate_test_data:860 - Error generating test data: (422)
Reason: Unprocessable Entity
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'unprocessable entity', 'Date': 'Tue, 15 Jul 2025 01:11:47 GMT', 'Content-Length': '232'})
HTTP response body: {"code":"unprocessable entity","message":"failure writing points to database: partial write: field type conflict: input field \"cmcd_bl\" on measurement \"cloudfront_logs\" is type integer, already exists as type float dropped=201"}

2025-07-14 21:11:50.068 | INFO     | __main__:generate_test_data:844 - Writing 201 points to bucket 'cmcd-metrics'
2025-07-14 21:11:50.170 | ERROR    | __main__:generate_test_data:860 - Error generating test data: (422)
Reason: Unprocessable Entity
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'unprocessable entity', 'Date': 'Tue, 15 Jul 2025 01:11:50 GMT', 'Content-Length': '232'})
HTTP response body: {"code":"unprocessable entity","message":"failure writing points to database: partial write: field type conflict: input field \"cmcd_bl\" on measurement \"cloudfront_logs\" is type integer, already exists as type float dropped=201"}

2025-07-14 21:11:52.481 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:11:52.482 | INFO     | __main__:explore_database:695 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:11:52.644 | INFO     | __main__:get_cmcd_data:218 - Query returned 2 records
2025-07-14 21:11:52.812 | INFO     | __main__:get_cmcd_data:218 - Query returned 0 records
2025-07-14 21:11:53.526 | INFO     | __main__:get_cmcd_data:218 - Query returned 630 records
2025-07-14 21:11:55.960 | INFO     | __main__:generate_test_data:844 - Writing 201 points to bucket 'cmcd-metrics'
2025-07-14 21:11:56.054 | ERROR    | __main__:generate_test_data:860 - Error generating test data: (422)
Reason: Unprocessable Entity
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'unprocessable entity', 'Date': 'Tue, 15 Jul 2025 01:11:56 GMT', 'Content-Length': '232'})
HTTP response body: {"code":"unprocessable entity","message":"failure writing points to database: partial write: field type conflict: input field \"cmcd_bl\" on measurement \"cloudfront_logs\" is type integer, already exists as type float dropped=201"}

2025-07-14 21:12:16.056 | INFO     | __main__:main:865 - Starting CMCD MCP Server
2025-07-14 21:12:25.454 | INFO     | __main__:get_average_bitrate:236 - Getting average bitrate for time_range=-30m, session_id=None, content_id=None
2025-07-14 21:12:25.648 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:12:25.648 | INFO     | __main__:get_average_bitrate:243 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 21:12:25.648 | INFO     | __main__:get_average_bitrate:252 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:12:25.648 | INFO     | __main__:get_average_bitrate:259 - Selected bucket: cmcd-metrics
2025-07-14 21:12:25.866 | INFO     | __main__:get_cmcd_data:218 - Query returned 61 records
2025-07-14 21:12:26.026 | INFO     | __main__:get_cmcd_data:218 - Query returned 1 records
2025-07-14 21:12:26.027 | INFO     | __main__:get_average_bitrate:354 - Successfully calculated average bitrate: 3552.0 kbps
2025-07-14 21:46:10.682 | INFO     | __main__:get_average_bitrate:236 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-14 21:46:10.686 | ERROR    | __main__:get_cmcd_data:222 - Error querying InfluxDB: <urllib3.connection.HTTPSConnection object at 0x11af33230>: Failed to establish a new connection: [Errno 61] Connection refused
2025-07-14 21:46:10.686 | INFO     | __main__:get_average_bitrate:243 - Available buckets: {'status': 'error', 'message': '<urllib3.connection.HTTPSConnection object at 0x11af33230>: Failed to establish a new connection: [Errno 61] Connection refused'}
2025-07-14 21:46:10.686 | INFO     | __main__:get_average_bitrate:252 - Found buckets: []
2025-07-14 21:46:13.037 | ERROR    | __main__:get_cmcd_data:222 - Error querying InfluxDB: <urllib3.connection.HTTPSConnection object at 0x11af30bf0>: Failed to establish a new connection: [Errno 61] Connection refused
2025-07-14 21:46:13.037 | INFO     | __main__:explore_database:695 - Found buckets: []
2025-07-14 21:54:13.793 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:54:13.795 | INFO     | __main__:explore_database:695 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:54:13.956 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:54:14.125 | INFO     | __main__:get_cmcd_data:218 - Query returned 0 records
2025-07-14 21:54:15.048 | INFO     | __main__:get_cmcd_data:218 - Query returned 754 records
2025-07-14 21:54:19.766 | INFO     | __main__:get_average_bitrate:236 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-14 21:54:19.935 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:54:19.937 | INFO     | __main__:get_average_bitrate:243 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 21:54:19.938 | INFO     | __main__:get_average_bitrate:252 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:54:19.945 | INFO     | __main__:get_average_bitrate:259 - Selected bucket: cmcd-metrics
2025-07-14 21:54:20.178 | INFO     | __main__:get_cmcd_data:218 - Query returned 99 records
2025-07-14 21:54:20.349 | INFO     | __main__:get_cmcd_data:218 - Query returned 1 records
2025-07-14 21:54:20.351 | INFO     | __main__:get_average_bitrate:354 - Successfully calculated average bitrate: 3729.7672413793102 kbps
2025-07-14 21:54:20.528 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:54:20.529 | INFO     | __main__:analyze_buffer_events:482 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:54:20.530 | INFO     | __main__:analyze_buffer_events:489 - Selected bucket: cmcd-metrics
2025-07-14 21:54:20.763 | INFO     | __main__:get_cmcd_data:218 - Query returned 114 records
2025-07-14 21:54:20.940 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:54:20.941 | INFO     | __main__:identify_playback_errors:568 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:54:20.941 | INFO     | __main__:identify_playback_errors:575 - Selected bucket: cmcd-metrics
2025-07-14 21:54:21.174 | INFO     | __main__:get_cmcd_data:218 - Query returned 114 records
2025-07-14 21:54:21.355 | INFO     | __main__:get_cmcd_data:218 - Query returned 33 records
2025-07-14 21:55:37.247 | INFO     | __main__:get_average_bitrate:236 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-14 21:55:37.420 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:55:37.420 | INFO     | __main__:get_average_bitrate:243 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 21:55:37.421 | INFO     | __main__:get_average_bitrate:252 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:55:37.421 | INFO     | __main__:get_average_bitrate:259 - Selected bucket: cmcd-metrics
2025-07-14 21:55:37.644 | INFO     | __main__:get_cmcd_data:218 - Query returned 99 records
2025-07-14 21:55:37.816 | INFO     | __main__:get_cmcd_data:218 - Query returned 1 records
2025-07-14 21:55:37.816 | INFO     | __main__:get_average_bitrate:354 - Successfully calculated average bitrate: 3729.7672413793102 kbps
2025-07-14 21:55:39.806 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:55:39.809 | INFO     | __main__:explore_database:695 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:55:39.977 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:55:40.142 | INFO     | __main__:get_cmcd_data:218 - Query returned 0 records
2025-07-14 21:55:40.722 | INFO     | __main__:get_cmcd_data:218 - Query returned 754 records
2025-07-14 21:55:42.766 | INFO     | __main__:get_average_bitrate:236 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-14 21:55:42.936 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:55:42.938 | INFO     | __main__:get_average_bitrate:243 - Available buckets: {'status': 'success', 'result': [{'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_monitoring', 'id': 'd221d481fa4e315d', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 604800000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': '_tasks', 'id': '72c2d9b0b1cca6c5', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 259200000000000}}, {'measurement': None, 'field': None, 'value': None, 'time': None, 'tags': {}, 'raw_values': {'result': '_result', 'table': 0, 'name': 'cmcd-metrics', 'id': '1bc89cacdf311322', 'organizationID': '6acf06311679018b', 'retentionPolicy': None, 'retentionPeriod': 0}}], 'format': 'json'}
2025-07-14 21:55:42.938 | INFO     | __main__:get_average_bitrate:252 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:55:42.939 | INFO     | __main__:get_average_bitrate:259 - Selected bucket: cmcd-metrics
2025-07-14 21:55:43.161 | INFO     | __main__:get_cmcd_data:218 - Query returned 99 records
2025-07-14 21:55:43.344 | INFO     | __main__:get_cmcd_data:218 - Query returned 1 records
2025-07-14 21:55:43.345 | INFO     | __main__:get_average_bitrate:354 - Successfully calculated average bitrate: 3729.7672413793102 kbps
2025-07-14 21:56:31.658 | INFO     | __main__:main:1776 - Starting CMCD MCP Server
2025-07-14 21:57:23.828 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:57:23.999 | ERROR    | __main__:get_cmcd_data:222 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'invalid', 'Date': 'Tue, 15 Jul 2025 01:57:24 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"invalid","message":"runtime error @7:14-7:44: distinct: schema collision: cannot group float and boolean types together"}'

2025-07-14 21:57:26.424 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:57:26.425 | INFO     | __main__:explore_database:695 - Found buckets: ['_monitoring', '_tasks', 'cmcd-metrics']
2025-07-14 21:57:26.589 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:57:26.764 | INFO     | __main__:get_cmcd_data:218 - Query returned 0 records
2025-07-14 21:57:27.340 | INFO     | __main__:get_cmcd_data:218 - Query returned 938 records
2025-07-14 21:57:30.173 | INFO     | __main__:get_cmcd_data:218 - Query returned 3 records
2025-07-14 21:57:30.346 | ERROR    | __main__:get_cmcd_data:222 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'invalid', 'Date': 'Tue, 15 Jul 2025 01:57:30 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"invalid","message":"runtime error @7:14-7:44: distinct: schema collision: cannot group float and boolean types together"}'

2025-07-14 21:57:33.374 | INFO     | __main__:generate_test_data:1755 - Writing 115 points to bucket 'cmcd-metrics'
2025-07-14 21:57:33.461 | ERROR    | __main__:generate_test_data:1771 - Error generating test data: (422)
Reason: Unprocessable Entity
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'unprocessable entity', 'Date': 'Tue, 15 Jul 2025 01:57:33 GMT', 'Content-Length': '232'})
HTTP response body: {"code":"unprocessable entity","message":"failure writing points to database: partial write: field type conflict: input field \"cmcd_bl\" on measurement \"cloudfront_logs\" is type integer, already exists as type float dropped=115"}

2025-07-14 21:57:42.142 | INFO     | __main__:generate_test_data:1755 - Writing 115 points to bucket 'cmcd-metrics'
2025-07-14 21:57:42.238 | ERROR    | __main__:generate_test_data:1771 - Error generating test data: (422)
Reason: Unprocessable Entity
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'unprocessable entity', 'Date': 'Tue, 15 Jul 2025 01:57:42 GMT', 'Content-Length': '232'})
HTTP response body: {"code":"unprocessable entity","message":"failure writing points to database: partial write: field type conflict: input field \"cmcd_bl\" on measurement \"cloudfront_logs\" is type integer, already exists as type float dropped=115"}

2025-07-14 22:12:37.561 | ERROR    | __main__:get_cmcd_data:222 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'invalid', 'Date': 'Tue, 15 Jul 2025 02:12:37 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"invalid","message":"unsupported input type for mean aggregate: boolean"}'

2025-07-15 11:56:39.041 | ERROR    | __main__:get_cmcd_data:233 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'invalid', 'Date': 'Tue, 15 Jul 2025 15:56:39 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"invalid","message":"runtime error @6:10-6:43: distinct: schema collision: cannot group float and boolean types together"}'

2025-07-15 12:28:04.694 | ERROR    | __main__:get_cmcd_data:233 - Error querying InfluxDB: (400)
Reason: Bad Request
HTTP response headers: HTTPHeaderDict({'Content-Type': 'application/json; charset=utf-8', 'Vary': 'Accept-Encoding', 'X-Influxdb-Build': 'OSS', 'X-Influxdb-Version': 'dev', 'X-Platform-Error-Code': 'invalid', 'Date': 'Tue, 15 Jul 2025 16:28:04 GMT', 'Transfer-Encoding': 'chunked'})
HTTP response body: b'{"code":"invalid","message":"runtime error @6:10-6:43: distinct: schema collision: cannot group float and boolean types together"}'

2025-07-15 13:33:46.091 | ERROR    | __main__:get_cmcd_data:233 - Error querying InfluxDB: <urllib3.connection.HTTPSConnection object at 0x117d587d0>: Failed to establish a new connection: [Errno 61] Connection refused
2025-07-15 16:43:01.008 | INFO     | __main__:main:538 - Starting CMCD MCP Server
2025-07-15 16:43:54.847 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-15 17:49:22.072 | INFO     | __main__:main:538 - Starting CMCD MCP Server
2025-07-15 17:49:35.952 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-15 17:49:36.807 | INFO     | __main__:get_cmcd_data:207 - Query returned 492 records
2025-07-15 17:49:36.982 | INFO     | __main__:get_cmcd_data:207 - Query returned 1 records
2025-07-15 17:49:36.983 | INFO     | __main__:get_average_bitrate:312 - Successfully calculated average bitrate: 3546.0848249027235 kbps
2025-07-15 17:50:16.231 | INFO     | __main__:get_average_bitrate:225 - Getting average bitrate for time_range=-24h, session_id=None, content_id=None
2025-07-15 17:50:16.825 | INFO     | __main__:get_cmcd_data:207 - Query returned 492 records
2025-07-15 17:50:17.000 | INFO     | __main__:get_cmcd_data:207 - Query returned 1 records
2025-07-15 17:50:17.000 | INFO     | __main__:get_average_bitrate:312 - Successfully calculated average bitrate: 3546.0848249027235 kbps
2025-07-15 17:50:19.844 | INFO     | __main__:get_cmcd_data:207 - Query returned 2569 records
2025-07-15 17:50:22.619 | INFO     | __main__:get_cmcd_data:207 - Query returned 2569 records
2025-07-15 17:50:22.988 | INFO     | __main__:get_cmcd_data:207 - Query returned 543 records
2025-07-15 21:07:33.712 | ERROR    | __main__:get_cmcd_data:211 - Error querying InfluxDB: <urllib3.connection.HTTPSConnection object at 0x127e07b00>: Failed to establish a new connection: [Errno 61] Connection refused
2025-07-15 21:08:29.508 | INFO     | __main__:get_cmcd_data:207 - Query returned 4117 records
